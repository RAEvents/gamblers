var T="https://retroachievements.org/API",x=(e,t,o,r={})=>{let i=`${e}/${t}`.replaceAll(/([^:]\/)\/+/g,"$1"),a={z:o.username,y:o.webApiKey};for(let[n,s]of Object.entries(r))i.includes(`:${n}`)?i=i.replace(`:${n}`,String(s)):s!==void 0&&(a[n]=String(s));return`${i}?${new URLSearchParams(a).toString()}`},k=async e=>{let{url:t}=e,o=new Headers({"User-Agent":"RetroAchievements-api-js/2.1.0"}),r=await fetch(t,typeof window!==void 0?{}:{headers:o});if(!r.ok)throw new Error(`HTTP Error: Status ${r.status} ${r.statusText}`);return await r.json()};function u(){return u=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r])}return e},u.apply(this,arguments)}var l=(e,t={})=>{let{shouldCastToNumbers:o,shouldMapToBooleans:r}=t,i=e;if(Array.isArray(e)){let a=[];for(let n of e)a.push(l(n,t));i=a}else if(!Array.isArray(e)&&e instanceof Object){let a={};for(let[n,s]of Object.entries(e)){let c=s;o!=null&&o.includes(n)&&(c=s===null?null:Number(s)),r!=null&&r.includes(n)&&(c=s===null?null:String(s)==="1"),a=u({},a,{[S(n)]:l(c,t)})}i=a}return i},S=e=>{if(e.toUpperCase()===e)return e.toLowerCase();let t=e.charAt(0).toLowerCase()+e.slice(1);return t=t.replaceAll("ID","Id"),t=t.replaceAll("URL","Url"),t=t.replaceAll("rA","ra"),t=t.replaceAll("visibleUserawards","visibleUserAwards"),t};var p,h,g;(function(e){e[e.NewSet=0]="NewSet",e[e.Revision=1]="Revision"})(p||(p={})),function(e){e[e.Active=0]="Active",e[e.Complete=1]="Complete",e[e.Dropped=2]="Dropped"}(h||(h={})),function(e){e[e.Primary=0]="Primary",e[e.Collaboration=1]="Collaboration"}(g||(g={}));var f,v;(function(e){e[e.CoreAchievements=3]="CoreAchievements",e[e.UnofficialAchievements=5]="UnofficialAchievements"})(f||(f={})),function(e){e.Primary="0",e.Collaboration="1"}(v||(v={}));var y=async(e,t)=>{let{username:o}=t,r=x(T,"/API_GetUserProfile.php",e,{u:o}),i=await k({url:r});return l(i,{shouldCastToNumbers:["TotalPoints","TotalSoftcorePoints","TotalTruePoints","Permissions"],shouldMapToBooleans:["Untracked","UserWallActive"]})};var d=e=>{if(!e.username||!e.webApiKey)throw new Error(`
      buildAuthorization() requires an object containing a
      username and webApiKey. eg:

      const authorization = buildAuthorization({
        username: "myUserName",
        webApiKey: "myWebApiKey"
      })
    `);return e};var C=e=>new Promise(t=>setTimeout(()=>t(),e)),G=200;var A=0;async function b(){await C(G*Math.pow(2,A))}function w(){A=0}async function I(e,t){try{let o=await y(e,{username:t});return{untracked:o.untracked,username:t,userPic:o.userPic}}catch(o){if(o.message.includes("404"))return{untracked:!0,username:t,userPic:`/UserPic/${t}.png`}}}function P(e,...t){let o="";for(let[r,i]of e.entries())o+=i,r in t&&(o+=t[r]);return o}async function D(){if(localStorage.getItem("auth")){let e=JSON.parse(localStorage.getItem("auth"));"apikey"in e&&(e.webApiKey=e.apikey,delete e.apikey,localStorage.setItem("auth",JSON.stringify(e)));let t=d(e);return t.toString=function(){return`z=${this.username}&y=${this.webApiKey}`},t}else return await N()}function N(){let t=document.getElementById("authModalTemplate").content.cloneNode(!0),o=t.children[0].querySelector("button");return document.body.appendChild(t),new Promise(r=>{o.addEventListener("click",i=>{let a=document.querySelector("div.authModal"),n={username:a.querySelector("input[name='username']").value,webApiKey:a.querySelector("input[name='apikey']").value};a.querySelector("input[name='saveinfo']").checked&&localStorage.setItem("auth",JSON.stringify(n)),document.body.removeChild(a),r(d(n))})})}document.getElementById("verify").addEventListener("click",async()=>{let e=await D();w();let t=Array.from(document.getElementById("users").value.split(`
`)),o=[];m("output"),output.innerHTML=P`<h1>Untracked</h1><hr /><div class="progress"><span class="spinner"></span><span class="amount"></span></div>`;let r=output.querySelector(".progress"),i=output.querySelector(".progress > .amount"),a=0;for(let n of t){let s=await I(e,n);s.untracked&&o.push(s),await b(),i.innerText=`${++a} / ${t.length}`}if(o.length==0){r.innerHTML="No untracked users!";return}for(let n of o){let s=document.createElement("div");s.className="user",s.innerHTML=P`<img src=${`https://retroachievements.org${n.userPic}`}></img><a href=${`https://retroachievements.org/user/${n.username}`}>${n.username}</span>`,r.parentElement.append(s)}r.remove()});document.getElementById("clear").addEventListener("click",()=>{document.getElementById("users").value="",document.getElementById("output").innerHTML="",m("submission")});document.getElementById("resetAuth").addEventListener("click",()=>{localStorage.removeItem("auth")});for(let e of document.querySelectorAll("#tabs > div")){let t=e.dataset.target;e.addEventListener("mousedown",()=>{m(t)})}function m(e){document.getElementById(e).style.display="block";for(let t of document.querySelectorAll(`#content > :not(#${e})`))t.style.display="none";for(let t of document.querySelectorAll("#tabs > div"))t.classList.remove("selected"),t.dataset.target==e&&t.classList.add("selected")}
//# sourceMappingURL=app.js.map
